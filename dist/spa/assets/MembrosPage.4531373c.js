import{a1 as N,p as h,a2 as D,a3 as i,f as s,aI as C,a8 as t,A as b,_ as V,q as r,t as c,l as x,aJ as L,aK as O,r as g,a5 as U,o as F,a6 as k,a7 as R,a4 as j,aL as P,Q as z}from"./index.dcbcb52e.js";import{Q}from"./QSpace.8cb73550.js";import{Q as Y,a as G}from"./QTable.52af0996.js";import{s as J}from"./vue-json-excel.esm.d6adb479.js";import{C as K}from"./ClosePopup.e67af9ae.js";import{u as H}from"./use-quasar.639bb423.js";import{u as W}from"./userApi.50caa57d.js";import{u as X}from"./useNotify.52f1dd01.js";import"./QList.e3c3b9a0.js";import"./QSelect.22c55753.js";import"./format.0219e714.js";import"./rtl.b51694b1.js";const Z=[{name:"nome",required:!0,label:"Nome completo",align:"left",field:"nome",sortable:!0},{name:"naturalidade",align:"left",label:"Naturalidade",field:"naturalidade",sortable:!0},{name:"data_nascimento",label:"Data de nascimento",align:"left",field:"data_nascimento",sortable:!0},{name:"num_bilhete",label:"N\xBA do documento",align:"left",field:"num_bilhete",sortable:!0},{name:"status",label:"Status do membro",field:"status",align:"left",sortable:!0},{name:"options",align:"left",label:"Op\xE7\xF5es",field:"options"}],$={props:{dados:{type:Object,required:!0},show:{type:Boolean}},setup(l,{emit:n}){return{closeModal:()=>{n("modalClose")}}}},ee={class:"text-h6"},oe={class:"text-body2"},ae={class:"text-body2"},te={class:"text-body2"},se={class:"text-body2"},ne={class:"text-body2"},le={class:"text-body2"},de={class:"text-body2"},re={key:0,class:"text-body2"},ie={class:"text-red-10"},ce={key:1,class:"text-body2"},me={class:"text-green-10"};function ue(l,n,o,e,u,_){return h(),D(O,{"model-value":o.show,persistent:""},{default:i(()=>[s(L,null,{default:i(()=>[s(C,{class:"row items-center q-pb-none"},{default:i(()=>[t("div",ee,[s(b,{flat:"",label:"Mais detalhes do membro",icon:"mdi-account-tie",color:"blue-10"})]),s(Q),V(s(b,{icon:"close",flat:"",round:"",dense:"",onClick:e.closeModal},null,8,["onClick"]),[[K]])]),_:1}),s(C,null,{default:i(()=>[t("p",oe,[r(" Nome: "),t("strong",null,c(o.dados.nome),1)]),t("p",ae,[r(" Nome do pai: "),t("strong",null,c(o.dados.nome_pai),1)]),t("p",te,[r(" Nome da ma\xEA: "),t("strong",null,c(o.dados.nome_mae),1)]),t("p",se,[r(" Naturalidade: "),t("strong",null,c(o.dados.naturalidade),1)]),t("p",ne,[r(" N\xBA do Documento: "),t("strong",null,c(o.dados.num_bilhete),1)]),t("p",le,[r(" Data de nascimento: "),t("strong",null,c(o.dados.data_nascimento),1)]),t("p",de,[r(" Idade: "),t("strong",null,c(new Date().getFullYear()-new Date(o.dados.data_nascimento).getFullYear())+" anos",1)]),o.dados.status=="N\xE3o baptizado"?(h(),x("p",re,[r(" Statu do Membro: "),t("strong",ie,c(o.dados.status),1)])):(h(),x("p",ce,[r(" Statu do Membro: "),t("strong",me,c(o.dados.status),1)]))]),_:1})]),_:1})]),_:1},8,["model-value"])}var fe=N($,[["render",ue]]);function M(l){setTimeout(()=>{window.URL.revokeObjectURL(l.href)},1e4),l.remove()}function be(l,n,o={}){const{mimeType:e,byteOrderMark:u,encoding:_}=typeof o=="string"?{mimeType:o}:o,m=_!==void 0?new TextEncoder(_).encode([n]):n,p=u!==void 0?[u,m]:[m],d=new Blob(p,{type:e||"application/octet-stream"}),a=document.createElement("a");a.href=window.URL.createObjectURL(d),a.setAttribute("download",l),typeof a.download=="undefined"&&a.setAttribute("target","_blank"),a.classList.add("hidden"),a.style.position="fixed",document.body.appendChild(a);try{return a.click(),M(a),!0}catch(y){return M(a),y}}const _e={"Nome completo":"nome","Nome do Pai":"nome_pai","Nome da ma\xEA":"nome_mae",Naturalidade:"naturalidade","N\xBA de documento":"num_bilhete","Data de nascimento":"data_nascimento",G\u00EAnero:"genero","Data de baptismo":"data_baptismo","Data de ingresso":"data_ingresso","Status do membro":"status"},ge={components:{detalhesMembro:fe,downloadExcel:J},setup(){const l="membros",{user:n}=R(),{notifyError:o}=X(),e=g([]),u=g({}),_=be(),m=g(!1),{list:p,remove:d}=W(),a=H(),y=g(!1),S=g(""),T=g(5),w=U(),q=f=>{w.push({name:"form-cadastro",params:{id:f}})},A=()=>{m.value=!1},v=async()=>{try{a.loading.show({message:"Carregando informa\xE7\xF5es"}),e.value=await p(l)}catch{}finally{a.loading.hide()}},B=f=>{u.value=f,m.value=!0},E=async f=>{try{a.dialog({title:"Confirma\xE7\xE3o",message:`tens a certeza que pretendes eliminar o (a) ${f.nome} da base de dados da Igreja ?`,cancel:!0,persistent:!0}).onOk(async()=>{a.loading.show({message:"Apagando dados do membro..."}),await d(l,f.id),v(),notifySuccess("Membro apagado com sucesso")})}catch(I){o(I.message)}finally{a.loading.hide()}};return F(()=>{n.value.user_metadata.funcao=="Secret\xE1rio"&&(o("Acesso limitado..."),w.push({name:"secretaria"})),n.value.user_metadata.funcao=="Tesoureiro"&&(o("Acesso limitado..."),w.push({name:"financas"})),v()}),{columns:Z,membros:e,loading:y,editForm:q,filter:S,rowCount:T,apagarMembro:E,showDialoge:m,detalhesInfo:B,dados:u,modalClose:A,excel:_,fields:_e}}},pe={class:"q-pa-md"};function he(l,n,o,e,u,_){const m=k("download-excel"),p=k("detalhes-membro");return h(),x("div",pe,[s(Y,{dense:"",flat:"",bordered:"",title:"Treats",rows:e.membros,columns:e.columns,"row-key":"id",filter:e.filter,loading:e.loading},{top:i(()=>[s(b,{dense:"",outline:"",icon:"mdi-database",color:"primary",disable:e.loading,label:"Cadastrar novo membro",to:{name:"form-cadastro"}},null,8,["disable"]),e.membros.length!==0?(h(),D(b,{key:0,outline:"",dense:"",icon:"mdi-file-excel",color:"green-10",disable:e.loading,class:"q-ml-sm"},{default:i(()=>[s(m,{data:e.membros,fields:e.fields,worksheet:"Membros da congrega\xE7\xE3o",name:"Membros.xls"},{default:i(()=>[r("Exportar para Excel")]),_:1},8,["data","fields"])]),_:1},8,["disable"])):j("",!0),s(Q),s(P,{outlined:"",borderless:"",dense:"",debounce:"300",color:"primary",modelValue:e.filter,"onUpdate:modelValue":n[0]||(n[0]=d=>e.filter=d),label:"Procurar membro"},{append:i(()=>[s(z,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-options":i(d=>[s(G,{props:d},{default:i(()=>[s(b,{dense:"",flat:"",icon:"mdi-file-edit",color:"secondary",onClick:a=>e.editForm(d.row.id)},null,8,["onClick"]),s(b,{dense:"",flat:"",icon:"mdi-delete-forever-outline",color:"negative",onClick:a=>e.apagarMembro(d.row)},null,8,["onClick"]),s(b,{dense:"",flat:"",icon:"mdi-eye-outline",color:"blue-grey-8",onClick:a=>e.detalhesInfo(d.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter","loading"]),s(p,{dados:e.dados,show:e.showDialoge,onModalClose:e.modalClose},null,8,["dados","show","onModalClose"])])}var qe=N(ge,[["render",he]]);export{qe as default};
