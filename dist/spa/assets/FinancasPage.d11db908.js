import{a1 as v,r as g,a5 as O,o as k,a6 as q,p as b,a2 as _,a3 as r,a7 as V,f as o,A as d,a8 as y,a9 as A,aL as z,Q as N,q as B,a4 as D}from"./index.dcbcb52e.js";import{Q as E,a as I}from"./QTable.52af0996.js";import{Q as P}from"./QPage.1d89285e.js";import{Q as T,a as S}from"./QLayout.f201702f.js";import{s as F}from"./vue-json-excel.esm.d6adb479.js";import{u as L}from"./use-quasar.639bb423.js";import{u as R}from"./userApi.50caa57d.js";import{u as U}from"./useNotify.52f1dd01.js";import"./QList.e3c3b9a0.js";import"./QSelect.22c55753.js";import"./format.0219e714.js";import"./rtl.b51694b1.js";const h=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"AOA"}).format(a),j=[{name:"membro_id",required:!0,label:"C\xF3digo",align:"left",field:"membro_id",sortable:!0},{name:"dizimo",align:"left",label:"D\xEDzimos",field:"dizimo",sortable:!0,format:a=>h(a)},{name:"oferta",label:"Ofertas",align:"left",field:"oferta",sortable:!0,format:a=>h(a)},{name:"data",label:"Data",align:"left",field:"data",sortable:!0},{name:"options",align:"left",label:"Op\xE7\xF5es",field:"options"}],M={"C\xF3digo do dep\xF3sito":"membro_id","Valor de d\xEDzimos":"dizimo","Valor de ofertas":"ofertas","Data do dep\xF3sito":"data"},G={name:"table-ofertorio",components:{downloadExcel:F},setup(a){const{user:s}=V(),c="ofertorio",e=g(""),f=g([]),i=L(),{list:u,remove:t}=R(),n=O(),{notifyError:m,notifySuccess:w}=U();k(()=>{s.value.user_metadata.funcao=="Secret\xE1rio"&&(m("Acesso limitado..."),n.push({name:"secretaria"})),s.value.user_metadata.funcao=="Tesoureiro"&&(m("Acesso limitado..."),n.push({name:"financas"})),p()});const Q=l=>{n.push({name:"form-cadastro-ofertorio",params:{id:l}})},x=async l=>{try{i.dialog({title:"Confirma\xE7\xE3o",message:`tens a certeza que pretendes eliminar o c\xF3digo ( ${l.membro_id} ) de ofertorio da base de dados da Igreja ?`,cancel:!0,persistent:!0}).onOk(async()=>{i.loading.show({message:"Apagando informa\xE7\xF5es do ofert\xF3rio..."}),await t(c,l.id),p(),w("Ofert\xF3rio apagado com sucesso")})}catch(C){m(C.message)}finally{i.loading.hide()}},p=async()=>{try{i.loading.show({message:"Carregar dados de ofert\xF3rio"}),f.value=await u(c)}catch(l){m(l.message)}finally{i.loading.hide()}};return{ofertorios:f,columns:j,filter:e,editOfertorio:Q,apagarOfertorio:x,fields:M}}},H={class:"q-gutter-x-sm text-right"},J={class:"col-12 q-gutter-md"};function K(a,s,c,e,f,i){const u=q("download-excel");return b(),_(T,null,{default:r(()=>[o(S,null,{default:r(()=>[o(P,{padding:""},{default:r(()=>[o(d,{flat:"",icon:"mdi-chess-bishop",color:"green-10",label:"controlo de dep\xF3sito de d\xEDzimos e ofert\xF3rio dos  membros"}),y("div",H,[y("div",J,[o(d,{dense:"",icon:"mdi-cart-arrow-down",color:"green-9",label:"Dep\xF3sito",class:"q-mb-md col-6",to:{name:"form-cadastro-ofertorio"}})])]),o(A),o(z,{class:"col-6",outlined:"",dense:"",modelValue:e.filter,"onUpdate:modelValue":s[0]||(s[0]=t=>e.filter=t),label:"Pesquisar"},{prepend:r(()=>[o(N,{name:"mdi-magnify"})]),_:1},8,["modelValue"]),e.ofertorios.length!==0?(b(),_(d,{key:0,outline:"",dense:"",icon:"mdi-file-excel",color:"green-10",disable:a.loading,class:"q-mt-md"},{default:r(()=>[o(u,{data:e.ofertorios,fields:e.fields,worksheet:"Nossos ofertorio",name:"ofertorios.xls"},{default:r(()=>[B("Exportar para Excel")]),_:1},8,["data","fields"])]),_:1},8,["disable"])):D("",!0),o(E,{dense:"",title:"Ofert\xF3rios",rows:e.ofertorios,columns:e.columns,filter:e.filter,"row-key":"name",class:"q-mt-md"},{"body-cell-options":r(t=>[o(I,{props:t},{default:r(()=>[o(d,{flat:"",dense:"",color:"green-10",icon:"mdi-file-edit",onClick:n=>e.editOfertorio(t.row.id)},null,8,["onClick"]),o(d,{flat:"",dense:"",color:"red-10",icon:"mdi-delete-forever-outline",onClick:n=>e.apagarOfertorio(t.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"])]),_:1})]),_:1})]),_:1})}var le=v(G,[["render",K]]);export{le as default};
